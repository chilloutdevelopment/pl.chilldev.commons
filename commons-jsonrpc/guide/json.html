
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at 2015-11-03
 Rendered using Reflow Maven Skin 1.1.1 (http://andriusvelykis.github.io/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>ChillDev Commons JSON-RPC &#x2013; JSON extras</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />

		<link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap.min.css" rel="stylesheet" />
		<link href="../css/docs.css" rel="stylesheet" />
		<link href="../css/reflow-skin.css" rel="stylesheet" />

		<link href="http://yandex.st/highlightjs/7.5/styles/default.min.css" rel="stylesheet" />

		<link href="../css/lightbox.css" rel="stylesheet" />

		<link href="../css/site.css" rel="stylesheet" />
		<link href="../css/print.css" rel="stylesheet" media="print" />

		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->



	</head>

	<body class="page-guide-json project-commons-jsonrpc" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target="#top-nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="http://chilldev.pl"><img src="http://static.chilldev.pl/images/chilldevpl.png" alt="Chillout Development"/></a>
					<div class="nav-collapse collapse" id="top-nav-collapse">
						<ul class="nav pull-right">
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Main <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="https://github.com/chilloutdevelopment/pl.chilldev.commons/" title="GitHub project" class="externalLink">GitHub project</a></li>
									<li ><a href="http://chilldev.pl/" title="Chillout Development" class="externalLink">Chillout Development</a></li>
									<li ><a href="http://wrzasq.pl/" title="Wrzasq.pl" class="externalLink">Wrzasq.pl</a></li>
									<li ><a href="https://www.facebook.com/chilldev" title="ChillDev @ Facebook" class="externalLink">ChillDev @ Facebook</a></li>
									<li ><a href="https://www.facebook.com/wrzasqpl" title="Wrzasq.pl @ Facebook" class="externalLink">Wrzasq.pl @ Facebook</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Parent Project <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="../../index.html" title="ChillDev Commons">ChillDev Commons</a></li>
								</ul>
							</li>
							<li class="dropdown active">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Guide <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li ><a href="rpc.html" title="JSON-RPC dispatcher">JSON-RPC dispatcher</a></li>
									<li ><a href="mina.html" title="Mina I/O">Mina I/O</a></li>
									<li ><a href="listener.html" title="Building listener">Building listener</a></li>
									<li ><a href="daemon.html" title="Building daemon">Building daemon</a></li>
									<li ><a href="client.html" title="Building client">Building client</a></li>
									<li class="active"><a href="" title="JSON extras">JSON extras</a></li>
								</ul>
							</li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Project Documentation <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li class="dropdown-submenu ">
										<a href="../project-info.html" title="Project Information">Project Information</a>
										<ul class="dropdown-menu">
											<li ><a href="../integration.html" title="Continuous Integration">Continuous Integration</a></li>
											<li ><a href="../dependencies.html" title="Dependencies">Dependencies</a></li>
											<li ><a href="../dependency-info.html" title="Dependency Information">Dependency Information</a></li>
											<li ><a href="../distribution-management.html" title="Distribution Management">Distribution Management</a></li>
											<li ><a href="../index.html" title="About">About</a></li>
											<li ><a href="../issue-tracking.html" title="Issue Tracking">Issue Tracking</a></li>
											<li ><a href="../license.html" title="Project License">Project License</a></li>
											<li ><a href="../plugin-management.html" title="Plugin Management">Plugin Management</a></li>
											<li ><a href="../plugins.html" title="Project Plugins">Project Plugins</a></li>
											<li ><a href="../team-list.html" title="Project Team">Project Team</a></li>
											<li ><a href="../source-repository.html" title="Source Repository">Source Repository</a></li>
											<li ><a href="../project-summary.html" title="Project Summary">Project Summary</a></li>
										</ul>
									</li>
									<li class="dropdown-submenu ">
										<a href="../project-reports.html" title="Project Reports">Project Reports</a>
										<ul class="dropdown-menu">
											<li ><a href="../checkstyle.html" title="Checkstyle">Checkstyle</a></li>
											<li ><a href="../dependency-analysis.html" title="Dependency Analysis">Dependency Analysis</a></li>
											<li ><a href="../apidocs/index.html" title="JavaDocs">JavaDocs</a></li>
											<li ><a href="../xref/index.html" title="Source Xref">Source Xref</a></li>
											<li ><a href="../xref-test/index.html" title="Test Source Xref">Test Source Xref</a></li>
											<li ><a href="../surefire-report.html" title="Surefire Report">Surefire Report</a></li>
											<li ><a href="../cobertura/index.html" title="Cobertura Test Coverage">Cobertura Test Coverage</a></li>
											<li ><a href="../findbugs.html" title="FindBugs">FindBugs</a></li>
										</ul>
									</li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>

	<div class="container">

	<!-- Masthead
	================================================== -->

	<header>
	<div class="jumbotron subhead">
		<div class="row" id="banner">
			<div class="span12">
				<div class="pull-left">
					<div id="bannerLeft"><h1>ChillDev Commons</h1></div>
				</div>
				<div class="pull-right">
					<a href="http://wrzasq.pl" id="bannerRight"><h1><img src="http://static.wrzasq.pl/images/wrzasqpl.png" alt="Wrzasq.pl"/></h1></a>
				</div>
			</div>
		</div>
	</div>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span12">
			<div class="body-content">
<!-- -
# This file is part of the ChillDev-Commons.
#
# @license http://mit-license.org/ The MIT license
# @copyright 2015 © by Rafał Wrzeszcz - Wrzasq.pl. --> 
<div class="page-header">
 <h1>JSON extras</h1>
</div> 
<p>As the name says, <a class="externalLink" href="http://www.jsonrpc.org/specification"><b>JSON-RPC</b></a> utilizes <a class="externalLink" href="http://json.org/"><b>JSON</b></a> for data representation. By analogy, <a class="externalLink" href="http://software.dzhuvinov.com/json-rpc-2.0-base.html"><b>JSON-RPC 2.0 Base</b></a> librar which handles RPC layer utilizes <a class="externalLink" href="https://github.com/netplex/json-smart-v2"><b>json-smart</b></a> library for JSON serialization. Unfortunately it is very limited. It’s not simple to fill all the gaps and refactor it from outside, but some improvements can be done. This package contains so additional extras that can be used out of the box.</p> 
<div class="section"> 
 <h2 id="JSON_writers">JSON writers</h2> 
 <div class="section"> 
  <h3 id="String-dumping">String-dumping</h3> 
  <p><tt>pl.chilldev.commons.jsonrpc.json.writer.StringDumpingWriter</tt> allows to register serializer for any type that should be dumped into JSON using it’s string representation - for example <tt>java.util.UUID</tt>:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>import java.time.OffsetDateTime;
import java.time.format.DateTimeFormatter;

import net.minidev.json.JSONValue;

import pl.chilldev.commons.jsonrpc.json.writer.DateTimeWriter;

public class App
{
    public static void main(String[] args)
    {
        JSONValue.defaultWriter.registerWriter(
            new DateTimeWriter(DateTimeFormatter.ISO_OFFSET_DATE_TIME),
            OffsetDateTime.class
        );
    }
}
</pre> 
   </div> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="DateTime">DateTime</h3> 
  <p><tt>pl.chilldev.commons.jsonrpc.json.writer.DateTimeWriter</tt> allows for setting default formatter for Java8 Time API objects by specifying <tt>DateTimeFormatter</tt>:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>import java.util.UUID;

import net.minidev.json.JSONValue;

import pl.chilldev.commons.jsonrpc.json.writer.StringDumpingWriter;

public class App
{
    public static void main(String[] args)
    {
        JSONValue.defaultWriter.registerWriter(new StringDumpingWriter(), UUID.class);
    }
}
</pre> 
   </div> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Sort">Sort</h3> 
  <p><tt>pl.chilldev.commons.jsonrpc.json.writer.SortWriter</tt> is capable of dumping <b>Spring Data</b> <tt>Sort</tt> objects into JSON. They are dumped as a list of two-element arrays, where first element is property name and second one is sorting direction:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>Sort value = new Sort(
    new Sort.Order(Sort.Direction.ASC, &quot;id&quot;),
    new Sort.Order(Sort.Direction.DESC, &quot;name&quot;)
);

// will become
//[[&quot;id&quot;,&quot;ASC&quot;],[&quot;name&quot;,&quot;DESC&quot;]]
// this is the format that our ParamsRetriver recognizes when parsing the params from JSON
</pre> 
   </div> 
  </div> 
  <p>Usage is analogical to other writers:</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>import net.minidev.json.JSONValue;

import org.springframework.data.domain.Sort;

import pl.chilldev.commons.jsonrpc.json.writer.SortWriter;

public class App
{
    public static void main(String[] args)
    {
        JSONValue.defaultWriter.registerWriter(new SortWriter(), Sort.class);
    }
}
</pre> 
   </div> 
  </div> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Enhanced_params_retriever">Enhanced params retriever</h2> 
 <p><tt>pl.chilldev.commons.jsonrpc.json.ParamsRetriever</tt> is an extension of <tt>com.thetransactioncompany.jsonrpc2.util.NamedParamsRetriever</tt> (we only support named parameters!) which provides extraction methods for some additional common types:</p> 
 <ul> 
  <li><tt>java.util.UUID</tt> via <tt>.getUuid()</tt> and <tt>.getOptUuid()</tt>;</li> 
  <li><tt>org.springframework.data.domain.Sort</tt> via <tt>getSort()</tt>: it extracts list of order criteria (of form <tt>[[&quot;field1&quot;,&quot;ASC|DESC&quot;], [&quot;field2&quot;,&quot;ASC|DESC&quot;], [&quot;fieldN&quot;,&quot;ASC|DESC&quot;]]</tt>) into <tt>spring-data-core</tt> object;</li> 
  <li><tt>org.springframework.data.domain.Pageable</tt> via <tt>getPageable()</tt>: it extracts page request specification by composing it from page number, page limit and sort parameters.</li> 
 </ul> 
 <p><b>Note:</b> Even though <tt>ParamsRetriever</tt> class provides methods for <tt>Sort</tt>, <tt>Pageable</tt> etc., <tt>spring-data-core</tt> is marked as optional dependency to reduce footprint.</p> 
 <div class="section"> 
  <h3 id="Beans">Beans</h3> 
  <p>Our extended parameters retriever class also provides <tt>.getBean()</tt> method which allows for unserializing properties as a bean object.</p> 
  <div class="source"> 
   <div class="source"> 
    <pre>import pl.chilldev.commons.jsonrpc.json.ParamsRetriever;

// …somewhere in the code
ParamsRetriever params = new ParamsRetriever(request); // can also be constructed by passing a map directly

/*
assume the request:
{&quot;id&quot;:1,&quot;name&quot;:&quot;Chillout Development&quot;}
*/
MyBean myBean = params.getBean(MyBean.class);

// you can also fetch bean from the parameter sub-scope

/*
assume the request:
{&quot;data&quot;:{&quot;id&quot;:1,&quot;name&quot;:&quot;Chillout Development&quot;}}
*/
MyBean myBean = params.getBean(&quot;data&quot;, MyBean.class);
</pre> 
   </div> 
  </div> 
  <p><b>Note:</b> We use <a class="externalLink" href="http://wiki.fasterxml.com/JacksonHome"><b>Jackson</b></a> for data binding.</p> 
  <p><b>Note:</b> Jackson <tt>ObjectMapper</tt> instance that is used internally by <tt>ParamsRetriever</tt> and <tt>ConvertUtils</tt> is exposed as <tt>ParamsRetriever.OBJECT_MAPPER</tt> static property. It is <tt>final</tt>, so you can’t override it, but you can use it and register custom modules.</p> 
 </div> 
</div> 
<div class="section"> 
 <h2 id="Additional_utilities">Additional utilities</h2> 
 <p>Apart from extensions to existing libraries, there is also <tt>pl.chilldev.commons.jsonrpc.json.ConvertUtils</tt> class which provides additional routines for converting data from and into raw POJO structures. Particularly there is <tt>buildPage()</tt> method which builds <b>Spring Data</b> <tt>Page&lt;&gt;</tt> object from JSON response.</p> 
 <p>It also provides a <tt>NULL</tt>-safe wrapper for <b>Spring</b> converters via <tt>dump()</tt> method.</p> 
</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->

	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Main</li>
						<li >
							<a href="https://github.com/chilloutdevelopment/pl.chilldev.commons/" title="GitHub project" class="externalLink">GitHub project</a>
						</li>
						<li >
							<a href="http://chilldev.pl/" title="Chillout Development" class="externalLink">Chillout Development</a>
						</li>
						<li >
							<a href="http://wrzasq.pl/" title="Wrzasq.pl" class="externalLink">Wrzasq.pl</a>
						</li>
						<li >
							<a href="https://www.facebook.com/chilldev" title="ChillDev @ Facebook" class="externalLink">ChillDev @ Facebook</a>
						</li>
						<li >
							<a href="https://www.facebook.com/wrzasqpl" title="Wrzasq.pl @ Facebook" class="externalLink">Wrzasq.pl @ Facebook</a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Parent Project</li>
						<li >
							<a href="../../index.html" title="ChillDev Commons">ChillDev Commons</a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Guide</li>
						<li >
							<a href="rpc.html" title="JSON-RPC dispatcher">JSON-RPC dispatcher</a>
						</li>
						<li >
							<a href="mina.html" title="Mina I/O">Mina I/O</a>
						</li>
						<li >
							<a href="listener.html" title="Building listener">Building listener</a>
						</li>
						<li >
							<a href="daemon.html" title="Building daemon">Building daemon</a>
						</li>
						<li >
							<a href="client.html" title="Building client">Building client</a>
						</li>
						<li class="active">
							<a href="#" title="JSON extras">JSON extras</a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Project Documentation</li>
						<li >
							<a href="../project-info.html" title="Project Information">Project Information <i class="icon-chevron-right"></i></a>
						</li>
						<li >
							<a href="../project-reports.html" title="Project Reports">Project Reports <i class="icon-chevron-right"></i></a>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</footer>

	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2015 <a href="http://wrzasq.pl/">Rafał Wrzeszcz - Wrzasq.pl</a>. All Rights Reserved.</p>
				<p class="version-date"><span class="projectVersion">Version: 0.1.0. </span><span class="publishDate">Last Published: 2015-11-03. </span></p>
				<p><a href="http://github.com/andriusvelykis/reflow-maven-skin" title="Reflow Maven skin">Reflow Maven skin</a> by <a href="http://andrius.velykis.lt" target="_blank" title="Andrius Velykis">Andrius Velykis</a>.</p>
			</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>

	<script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
	<script src="../js/lightbox.min.js"></script>
	<script src="../js/reflow-scroll.js"></script>
	<script src="http://yandex.st/highlightjs/7.5/highlight.min.js"></script>

	<script src="../js/reflow-skin.js"></script>

	</body>
</html>
