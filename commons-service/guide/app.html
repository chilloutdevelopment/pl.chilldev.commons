<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7.1 at 2016-08-27 
 | Rendered using Apache Maven Fluido Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20160827" />
    <meta http-equiv="Content-Language" content="en" />
    <title>ChillDev Commons Service &#x2013; Service application</title>
    <link rel="stylesheet" href="../css/apache-maven-fluido-1.5.min.css" />
    <link rel="stylesheet" href="../css/site.css" />
    <link rel="stylesheet" href="../css/print.css" media="print" />

      
    <script type="text/javascript" src="../js/apache-maven-fluido-1.5.min.js"></script>

                      </head>
        <body class="topBarDisabled">
          
        
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>ChillDev Commons Service</h2>
                </div>
                      </div>
        <div class="pull-right">                  <a href="http://wrzasq.pl" id="bannerRight">
                <h2><img src="http://static.wrzasq.pl/images/wrzasqpl.png" alt="Wrzasq.pl"/></h2>
                </a>
      </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
              
            
              
      
                            </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
              
                <ul class="nav nav-list">
                    <li class="nav-header">Main</li>
                              
      <li>
  
                          <a href="https://github.com/chilloutdevelopment/pl.chilldev.commons/" class="externalLink" title="GitHub project">
          <span class="none"></span>
        GitHub project</a>
            </li>
                
      <li>
  
                          <a href="http://chilldev.pl/" class="externalLink" title="Chillout Development">
          <span class="none"></span>
        Chillout Development</a>
            </li>
                
      <li>
  
                          <a href="http://wrzasq.pl/" class="externalLink" title="Wrzasq.pl">
          <span class="none"></span>
        Wrzasq.pl</a>
            </li>
                
      <li>
  
                          <a href="https://www.facebook.com/chilldev" class="externalLink" title="ChillDev @ Facebook">
          <span class="none"></span>
        ChillDev @ Facebook</a>
            </li>
                
      <li>
  
                          <a href="https://www.facebook.com/wrzasqpl" class="externalLink" title="Wrzasq.pl @ Facebook">
          <span class="none"></span>
        Wrzasq.pl @ Facebook</a>
            </li>
                              <li class="nav-header">Parent Project</li>
                              
      <li>
  
                          <a href="../../index.html" title="ChillDev Commons">
          <span class="none"></span>
        ChillDev Commons</a>
            </li>
                              <li class="nav-header">Guide</li>
                              
      <li class="active">
  
            <a href="#"><span class="none"></span>Service application</a>
          </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                                                                      
      <li>
  
                          <a href="../project-info.html" title="Project Information">
          <span class="icon-chevron-right"></span>
        Project Information</a>
                  </li>
                                                                                                                                                                                                
      <li>
  
                          <a href="../project-reports.html" title="Project Reports">
          <span class="icon-chevron-right"></span>
        Project Reports</a>
                  </li>
            </ul>
              
                
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                                                                                                                   <a href="http://maven.apache.org/" title="Maven" class="builtBy">
        <img class="builtBy"  alt="Apache Maven" src="http://maven.apache.org/images/logos/maven-feather.png"    />
      </a>
                                                                                                    <a href="http://chilldev.pl" title="Chillout Development" class="builtBy">
        <img class="builtBy"  alt="Chillout Development" src="http://static.chilldev.pl/images/chilldevpl.png"    />
      </a>
                                                                                                    <a href="http://wrzasq.pl" title="Wrzasq.pl" class="builtBy">
        <img class="builtBy"  alt="Wrzasq.pl" src="http://static.chilldev.pl/images/wrzasqpl.png"    />
      </a>
                      </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <!---
# This file is part of the ChillDev-Commons.
#
# @license http://mit-license.org/ The MIT license
# @copyright 2015 - 2016 © by Rafał Wrzeszcz - Wrzasq.pl.
--><h1>Service application</h1>
<p>This package is mainly oriented in exposing common architecture of network service application used by <b>Chillout Development</b>. It&#x2019;s a <b>Spring</b> configuration handling library that can be used together with <tt>commons-jsonrpc</tt> to build full network RPC service with less effort.</p>
<div class="section">
<h2><a name="BaseApplicationConfiguration"></a><tt>BaseApplicationConfiguration</tt></h2>
<p><tt>pl.chilldev.commons.service.config.BaseApplicationConfiguration</tt> is a Spring Java-config class that provides all services neccessary for building transactional JSON-RPC service:</p>

<ul>
  
<li><tt>introspector</tt> for JSON-RPC service building;</li>
  
<li><tt>validator</tt> for validating data;</li>
  
<li><tt>transactionAttributeSource</tt> for handling <tt>@Transactional</tt> annotations.</li>
</ul></div>
<div class="section">
<h2><a name="Spring_configuration_handling"></a>Spring configuration handling</h2>
<p>Usually application needs to customize mainly network and database connectivity. For that there are two abstract bean definition handlers which allow to handle generic configuration in a format:</p>

<div class="source">
<div class="source"><pre class="prettyprint">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;beans
    xmlns=&quot;http://www.springframework.org/schema/beans&quot;
    xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
    xmlns:sites=&quot;http://chilldev.pl/java/spring/sites&quot;
    xsi:schemaLocation=&quot;
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-4.0.xsd
        http://chilldev.pl/java/spring/sites http://chilldev.pl/schema/spring/chilldev-sites-0.0.5.xsd
&quot;&gt;
    &lt;sites:data-source
        name=&quot;jpa0&quot;
        jdbcUrl=&quot;jdbc:mysql://localhost/database?autoReconnect=true&amp;amp;useUnicode=true&amp;amp;characterEncoding=utf-8&quot;
        user=&quot;root&quot;
        password=&quot;secret&quot;
        /&gt;
    &lt;sites:listener
        name=&quot;chilldev.pl&quot;
        port=&quot;6000&quot;
        dataSource=&quot;jpa0&quot;
        /&gt;
&lt;/beans&gt;
</pre></div></div>
<p><b>Note:</b> <tt>sites</tt> is a sample namespace for custom configuration, but all the configuration structure is the same, handled by generic classes from <tt>commons-service</tt> library.</p>
<div class="section">
<h3><a name="Usage"></a>Usage</h3>
<p>To use this configuration stub in your application, you need to subclass these abstract handlers probviding missing pieces about how to bind your implementation to these beans (note that you are free to define any element names, class names are not related to element names).</p>
<p>For the data source connection, all that you have to do is to specify source packages for your models to be bound into data source entity manager:</p>

<div class="source">
<div class="source"><pre class="prettyprint">public class DataSourceBeanDefinitionParser
    extends AbstractDataSourceBeanDefinitionParser
{
    /**
     * {@inheritDoc}
     */
    @Override
    protected List&lt;String&gt; getPackagesToScan()
    {
        return Collections.singletonList(&quot;pl.chilldev.sites.service&quot;);
    }
}
</pre></div></div>
<p>For the listener you need to do two things - provide factory class that will produce listeners based on given API facades and provide it&#x2019;s backing implementation bean:</p>

<div class="source">
<div class="source"><pre class="prettyprint">public class ListenerBeanDefinitionParser
    extends AbstractListenerBeanDefinitionParser
{
    /**
     * {@inheritDoc}
     */
    @Override
    protected Class&lt;?&gt; getFactoryClass()
    {
        // this class should return listener for your API facades
        return ApiFacadeFactory.class;
    }

    /**
     * {@inheritDoc}
     */
    @Override
    protected BeanDefinition createApiFacadeBeanDefinition(String name)
    {
        // define your API facade bean and all it's dependencies

        GenericBeanDefinition apiFacadeBean = new GenericBeanDefinition();
        apiFacadeBean.setBeanClass(ApiFacadeImpl.class);
        apiFacadeBean.setAutowireMode(AbstractBeanDefinition.AUTOWIRE_CONSTRUCTOR);

        // required repositories
        ConstructorArgumentValues arguments = apiFacadeBean.getConstructorArgumentValues();
        arguments.addGenericArgumentValue(
            new RuntimeBeanReference(
                SiteRepository.class.getName() + AbstractDataSourceBeanDefinitionParser.SEPARATOR_BEANNAME + name
            )
        );
        arguments.addGenericArgumentValue(
            new RuntimeBeanReference(
                TagRepository.class.getName() + AbstractDataSourceBeanDefinitionParser.SEPARATOR_BEANNAME + name
            )
        );

        return apiFacadeBean;
    }
}
</pre></div></div>
<p>Usually, the factory class can be very simple and is mostly used to delegate facade-dispatcher binding:</p>

<div class="source">
<div class="source"><pre class="prettyprint">public class ApiFacadeFactory
{
    /**
     * Builds listener for API.
     *
     * @param name Listener name.
     * @param facade Data models facade.
     * @param dispatcher RPC dispatcher.
     * @return API listener.
     */
    public static Listener&lt;ApiFacade&gt; createListener(
        String name,
        ApiFacade facade,
        Dispatcher&lt;ApiFacade&gt; dispatcher
    )
    {
        return new Listener&lt;&gt;(
            name,
            facade,
            dispatcher
        );
    }
}
</pre></div></div></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                    2016
                        <a href="http://wrzasq.pl/">Rafał Wrzeszcz - Wrzasq.pl</a>.
            All rights reserved.    
                  <li id="publishDate" class="pull-right">Last Published: 2016-08-27</li>
              <li id="projectVersion" class="pull-right">
                    Version: 0.1.2
        </li>
            </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
